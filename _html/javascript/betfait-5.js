var iapiVersion="12.1.5";var iapiERR_OK=0;var iapiERR_NOK=-1;var iapiERR_BLOCKED=-2;var iapiCALLOUT_LOGIN="Login";var iapiCALLOUT_TEMPORARYTOKEN="GetTemporaryAuthenticationToken";var iapiCALLOUT_SESSIONVALIDATION="ValidateLoginSession";var iapiCALLOUT_MESSAGES="GetWaitingMessages";var iapiCALLOUT_SUBMITDIALOG="SubmitDialog";var iapiCALLOUT_FORGOTPASSWORD="ForgotPassword";var iapiCALLOUT_GETLOGGEDINPLAYER="GetLoggedInPlayer";var iapiCALLOUT_LOGOUT="Logout";var iapiEVENT_TIMER=10;var iapiUsername=null;var iapiPassword=null;var iapiRealMode=1;var iapiLanguageCode=null;var iapiDivname="iapidiv";var iapiIframename="iapiiframe";var iapiRealCookieIframe="iapirealcookieiframe";var iapiFunCookieIframe="iapifuncookieiframe";var iapiClientParams=[];var iapiWaitingMessagesId=0;var iapiCalloutFunctions=[];var iapiRequestIds=[];var iapiLoginSuccess=false;var iapiSessionValid=0;var iapiNextLogin=null;var iapiLoginModeDownload=false;var iapiLoginModeFlash=false;var iapiFlashLoginClientType=null;var iapiFlashLoginGameType=null;function iapiLogin(c,d,a,b){iapiLoginModeDownload=false;iapiLoginModeFlash=false;iapiBaseLogin(c,d,a,b);return iapiERR_OK}function iapiLaunchClient(f,c,i,e){if(iapiConf["clientUrl_"+f]){var b=iapiConf["clientUrl_"+f];if(c){b=iapiAddUrlParams(b,"game="+c)}if(i){b=iapiAddUrlParams(b,"preferedmode="+i)}if(iapiClientParams["clientParams_"+f]){b=iapiAddUrlParams(b,iapiClientParams["clientParams_"+f])}if(iapiLoginModeFlash){document.location=b;return}var h="width=800,height=600";if(iapiConf["windowSize_"+f]){var d=iapiConf["windowSize_"+f][c];if(d==undefined){d=iapiConf["windowSize_"+f]["default"]}if(d!=undefined&&iapiConf.windowSizes[d]){h=iapiConf.windowSizes[d]}}if(e!=null&&e.length>0){var g=document.getElementById(e);if(g){g.src=b;return iapiERR_OK}}else{e=""}windowParams=h+",toolbar=no,menubar=no,scrollbars=no,resizable=no";var a=window.open(b,e,windowParams);if(a==null||a.closed){return iapiERR_BLOCKED}return iapiERR_OK}return iapiERR_NOK}function iapiSetClientParams(b,a){iapiClientParams["clientParams_"+b]=a}function iapiRequestTemporaryToken(a,b){iapiClearRedirectRequests(iapiCALLOUT_TEMPORARYTOKEN,a);var c="GetTemporaryAuthenticationToken.php?casinoname="+iapiConf.casinoname+"&serviceType="+iapiConf.serviceType;if(b!=undefined){c+="&systemId="+b}else{c+="&systemId="+iapiConf.systemId}if(a!=undefined){c+="&realMode="+a}iapiMakeRedirectRequest(c,null,iapiCALLOUT_TEMPORARYTOKEN);return iapiERR_OK}function iapiDownloadLogin(d,a,b,c){iapiLoginModeDownload=true;iapiLoginModeFlash=false;iapiBaseLogin(d,a,b,c);return iapiERR_OK}function iapiFlashLogin(c,d,f,a,b,e){iapiLoginModeFlash=true;iapiLoginModeDownload=false;iapiFlashLoginClientType=b;iapiFlashLoginGameType=e;iapiBaseLogin(c,d,f,a);return iapiERR_OK}function iapiLogout(a,b){iapiUsername=null;iapiPassword=null;iapiClearRedirectRequests(iapiCALLOUT_LOGIN,b);if(b==1){iapiWriteClientCookie("loginSuccess=0&errorCode=0&expire=-1",1)}else{iapiWriteClientCookie("loginSuccess=0&errorCode=0&expire=-1",0)}var c="Logout.php?allSessions="+a+"&casinoname="+iapiConf.casinoname;if(b!=undefined){c+="&realMode="+b}iapiMakeRedirectRequest(c,null,iapiCALLOUT_LOGOUT)}function iapiSetCallout(b,a){iapiCalloutFunctions[b]=a;return iapiERR_OK}function iapiGetWaitingMessages(c,a){iapiClearRedirectRequests(iapiCALLOUT_MESSAGES,0);iapiClearRedirectRequests(iapiCALLOUT_MESSAGES,1);if(!c){c="login,bonus,alert"}var b="GetWaitingMessages.php?messageTypes="+c+"&casinoname="+iapiConf.casinoname+"&realMode="+a;iapiMakeRedirectRequest(b,null,iapiCALLOUT_MESSAGES);return iapiERR_OK}function iapiBonusConfirmation(b,c,d){var e="SubmitDialog.php?dialogType=BonusConfirmation&casinoname="+iapiConf.casinoname;if(d!=undefined){e+="&realMode="+d}var a=[];a.bonusIdentifier=b;if(c){a.accept=1}else{a.accept=0}iapiMakeRedirectRequest(e,a,iapiCALLOUT_SUBMITDIALOG)}function iapiValidateTCVersion(b,c,d){var e="ValidateLoginSession.php?validationType=TCVersion&casinoname="+iapiConf.casinoname;if(d!=undefined){e+="&realMode="+d}var a=[];a.termVersionReference=b;if(c){a.accept=1}else{a.accept=0}iapiMakeRedirectRequest(e,a,iapiCALLOUT_SESSIONVALIDATION)}function iapiValidatePasswordChange(b,c,d,e){var f="ValidateLoginSession.php?validationType=PasswordChange&casinoname="+iapiConf.casinoname;if(e!=undefined){f+="&realMode="+e}var a=[];a.oldPassword=b;a.newPassword=c;if(d){a.changePassword=1}iapiMakeRedirectRequest(f,a,iapiCALLOUT_SESSIONVALIDATION)}function iapiForgotPassword(b,c,e,d){var f="ForgotPassword.php?casinoname="+iapiConf.casinoname+"&realMode="+d;var a=[];a.username=b;a.email=c;a.birthDate=e;iapiMakeRedirectRequest(f,a,iapiCALLOUT_FORGOTPASSWORD)}function iapiGetLoggedInPlayer(a){var b="GetLoggedInPlayer.php?casinoname="+iapiConf.casinoname+"&realMode="+a;iapiMakeRedirectRequest(b,null,iapiCALLOUT_GETLOGGEDINPLAYER)}function iapiSetAuthenticationType(a){iapiConf.authenticationType=a}function iapiCallbackWaitingMessages(d){var e=iapiGetRequest(iapiWaitingMessagesId);if(!e){return}var a={errorCode:6,errorText:"Invalid response.",playerMessage:""};if(d){if(d.errorCode){a={errorCode:d.errorCode,errorText:d.errorText,playerMessage:d.playerMessage}}else{a=null}}else{d=a}if(a&&a.errorCode==6){if(e[3].length<iapiConf.loginDomainRetryCount){var b=(new Date().getTime())+Math.round(Math.random()*1000000);var c=setTimeout("iapiRequestFailed("+b+")",iapiConf.loginDomainRetryInterval*1000);iapiRegisterRequestId(b,iapiCALLOUT_MESSAGES,c,e[3],e[4],e[5]);return}}if(iapiCalloutFunctions[iapiCALLOUT_MESSAGES]){setTimeout(function(){iapiCalloutFunctions[iapiCALLOUT_MESSAGES](d)},iapiEVENT_TIMER)}}function iapiBaseLogin(c,d,a,b){if((iapiHasRedirectRequest(iapiCALLOUT_LOGIN))&&iapiRealMode!=a){iapiNextLogin=[c,d,a,b];return iapiERR_OK}iapiUsername=c;iapiPassword=d;if(a==1){iapiRealMode=1}else{iapiRealMode=0}iapiLanguageCode=b;iapiLoginSuccess=false;iapiWriteClientCookie("loginInProgress=1",iapiRealMode);iapiContinueLogin();return iapiERR_OK}function iapiContinueLogin(){iapiClearRedirectRequests(iapiCALLOUT_LOGIN,0);iapiClearRedirectRequests(iapiCALLOUT_LOGIN,1);var a="Login.php?casinoname="+iapiConf.casinoname+"&clientType="+iapiConf.clientType+"&clientVersion="+iapiConf.clientVersion+"&languageCode="+iapiLanguageCode;if(iapiLoginModeDownload){a+="&clientPlatform=download"}else{if(iapiConf.clientPlatform){a+="&clientPlatform="+iapiConf.clientPlatform}else{a+="&clientPlatform=flash"}}if(iapiConf.clientSkin){a+="&clientSkin="+iapiConf.clientSkin}if(iapiRealMode==1){a+="&realMode=1"}else{a+="&realMode=0"}var b=[];b.username=iapiUsername;if(iapiConf.authenticationType&&iapiConf.authenticationType=="externalToken"){b.externalToken=iapiPassword}else{b.password=iapiPassword}iapiMakeRedirectRequest(a,b,iapiCALLOUT_LOGIN)}function iapiWriteClientCookie(d,e){if(iapiLoginModeDownload){return}var a=iapiConf.clientCookieUrl;if(!a){return}if(a.indexOf("://")<0){a=location.protocol+"//"+a}var b=a+"?"+d+"&casinoname="+iapiConf.casinoname+"&realMode="+e;var c=iapiRealCookieIframe;if(e==0){c=iapiFunCookieIframe}iapiCreateDiv(iapiDivname);iapiCreateIframe(iapiDivname,c);iapiGet(c,b)}function iapiCreateDiv(b){if(document.getElementById(b)){return}var a=document.createElement("div");a.setAttribute("id",b);a.setAttribute("style","DISPLAY:none;");document.body.appendChild(a)}function iapiCreateIframe(e,a){var b=document.getElementById(e);if(document.getElementById(a)){b.removeChild(document.getElementById(a))}var c;try{c=document.createElement("<iframe name='"+a+"'>")}catch(d){c=document.createElement("iframe")}c.setAttribute("id",a);c.setAttribute("name",a);c.setAttribute("style","DISPLAY: none; LEFT: 0px; POSITION: absolute; TOP: 0px");c.setAttribute("width","0px");c.setAttribute("height","0px");c.setAttribute("border","0px");c.setAttribute("frameborder","0");c.setAttribute("src","javascript:false;");b.appendChild(c)}function iapiPost(e,a,b){var c="<html><head></head><body><form id='formid' target='"+e+"' method='POST' action='"+a+"'>";var d;for(d in b){if(typeof(b[d])!="function"){c+="<input type='hidden' name='"+d+"' value='"+b[d]+"'>"}}c+="</form><script type='text/javascript'>setTimeout(function(){document.getElementById('formid').submit();},100);<\/script></body></html>";iapiPostWindow(e,c)}function iapiPostWindow(f,g){var a=document.getElementById(f);if(a){try{a.contentWindow.document.open();a.contentWindow.document.write(g);a.contentWindow.document.close()}catch(d){var c="<script>document.domain='"+document.domain+"';<\/script>"+g;var b="javascript:'<script>window.onload=function(){var ed=\\'"+escape(escape(c))+"\\';document.write(unescape(ed));document.close();};<\/script>'";a.src=b}}}function iapiMakeRedirectRequest(c,l,g,b){if(!b){b=[]}else{if(b.length>=iapiConf.loginDomainRetryCount){return false}}var k=iapiConf.loginServer.split("|");if(b.length<k.length){var e;for(e in b){var m=b[e];var d;for(d in k){if(k[d]==m&&typeof(k[d])==="string"){k.splice(d,1);break}}}}var f=k[Math.floor(Math.random()*k.length)];b.push(f);requestUrl="https://"+f+"/"+c;var a=(new Date().getTime())+Math.round(Math.random()*1000000);if(g==iapiCALLOUT_GETLOGGEDINPLAYER){a=1234567890}if(iapiConf.redirectUrl&&g!=iapiCALLOUT_MESSAGES){requestUrl+="&redirectUrl="+escape(location.protocol+"//"+location.hostname+iapiConf.redirectUrl+"#requestId="+a)}else{requestUrl+="&cacheBreaker="+(new Date().getTime())}var h=setTimeout("iapiRequestFailed("+a+")",iapiConf.loginDomainRequestTimeout*1000);iapiRegisterRequestId(a,g,h,b,c,l);if(g==iapiCALLOUT_MESSAGES){iapiWaitingMessagesId=a;iapiJsonp(requestUrl,"iapiCallbackWaitingMessages")}else{iapiCreateDiv(iapiDivname);iapiCreateIframe(iapiDivname,iapiIframename+"_"+a);if(l){iapiPost(iapiIframename+"_"+a,requestUrl,l)}else{iapiGet(iapiIframename+"_"+a,requestUrl)}}return true}function iapiJsonp(a,b){scriptElement=document.createElement("SCRIPT");scriptElement.type="text/javascript";scriptElement.src=a+"&jsoncallback="+b+"&responseType=json";document.getElementsByTagName("HEAD")[0].appendChild(scriptElement)}function iapiGet(a,b){var c=document.getElementById(a);if(c){c.src=b}}function iapiAddUrlParams(a,b){if(a.indexOf("?")>0){a+="&"}else{a+="?"}return a+b}function iapiLoginFailedActions(a){iapiPassword=null;iapiLoginSuccess=false;iapiSessionValid=0;var b=a.errorCode;iapiWriteClientCookie("loginSuccess=0&errorCode="+b,iapiRealMode);if(iapiCalloutFunctions.login){setTimeout(function(){iapiCalloutFunctions.login(0,0,b,iapiRealMode)},iapiEVENT_TIMER)}if(iapiCalloutFunctions[iapiCALLOUT_LOGIN]){setTimeout(function(){iapiCalloutFunctions[iapiCALLOUT_LOGIN](a)},iapiEVENT_TIMER)}if(iapiLoginModeDownload){iapiDownloadHtcmd(0,0,b,"")}iapiCheckNextLogin()}function iapiTokenFailedActions(a){if(iapiCalloutFunctions.temporarytoken){setTimeout(function(){iapiCalloutFunctions.temporarytoken(0,null)},iapiEVENT_TIMER)}if(iapiCalloutFunctions[iapiCALLOUT_TEMPORARYTOKEN]){setTimeout(function(){iapiCalloutFunctions[iapiCALLOUT_TEMPORARYTOKEN](a)},iapiEVENT_TIMER)}if(iapiLoginModeDownload){iapiDownloadHtcmd(1,iapiSessionValid,0,"")}}function iapiCheckNextLogin(){if(iapiNextLogin!=null){var b=iapiNextLogin[0];var a=iapiNextLogin[1];var c=iapiNextLogin[2];var d=iapiNextLogin[3];iapiNextLogin=null;setTimeout(function(){iapiLogin(b,a,c,d)},iapiEVENT_TIMER)}}function iapiDownloadHtcmd(a,b,c,d){if(a&&d){var e="htcmd:login?";e=e+"username="+encodeURIComponent(iapiUsername);e=e+"&password="+encodeURIComponent(d);e=e+"&realmode="+iapiRealMode;e=e+"&type="+3;document.location=e}}function iapiRedirectCallback(ic){var jc=String(ic.requestId);var kc=iapiGetRequest(jc);if(!kc){return}var lc=kc[1];var mc=null;try{mc=JSON.parse(ic.redirectResponse)}catch(err){}if(mc==null){try{mc=eval("("+ic.redirectResponse+")")}catch(err){}}var nc={errorCode:6,errorText:"Invalid response.",playerMessage:""};if(mc){if(mc.errorCode){nc={errorCode:mc.errorCode,errorText:mc.errorText,playerMessage:mc.playerMessage}}else{nc=null}}else{mc=nc}if(nc&&nc.errorCode==6){if(kc[3].length<iapiConf.loginDomainRetryCount){var jc=(new Date().getTime())+Math.round(Math.random()*1000000);var oc=setTimeout("iapiRequestFailed("+jc+")",iapiConf.loginDomainRetryInterval*1000);iapiRegisterRequestId(jc,lc,oc,kc[3],kc[4],kc[5]);return}}if(lc==iapiCALLOUT_LOGIN){if(nc==null){iapiPassword=null;iapiLoginSuccess=true;iapiError=null;iapiSessionValid=1;var pc=mc.sessionValidationData;if(pc){iapiSessionValid=0}var qc="loginSuccess=1&sessionValid="+iapiSessionValid+"&loginDomain="+iapiConf.loginServer;iapiWriteClientCookie(qc,iapiRealMode);if(iapiCalloutFunctions.login){setTimeout(function(){iapiCalloutFunctions.login(1,iapiSessionValid,0,iapiRealMode)},iapiEVENT_TIMER)}if(iapiCalloutFunctions[iapiCALLOUT_LOGIN]){setTimeout(function(){iapiCalloutFunctions[iapiCALLOUT_LOGIN](mc)},iapiEVENT_TIMER)}if(iapiLoginModeDownload){if(iapiSessionValid){iapiRequestTemporaryToken(iapiRealMode)}else{iapiDownloadHtcmd(1,0,0,"")}}else{if(iapiLoginModeFlash){if(iapiSessionValid){var rc="real";if(!iapiRealMode){rc="fun"}iapiLaunchClient(iapiFlashLoginClientType,iapiFlashLoginGameType,rc)}else{iapiRedirectToWeblogin()}}}iapiCheckNextLogin()}else{iapiError=nc;iapiLoginFailedActions(mc)}}else{if(lc==iapiCALLOUT_TEMPORARYTOKEN){if(nc==null&&mc.sessionToken&&mc.sessionToken.sessionToken){if(iapiCalloutFunctions.temporarytoken){setTimeout(function(){iapiCalloutFunctions.temporarytoken(1,mc.sessionToken.sessionToken)},iapiEVENT_TIMER)}if(iapiCalloutFunctions[iapiCALLOUT_TEMPORARYTOKEN]){setTimeout(function(){iapiCalloutFunctions[iapiCALLOUT_TEMPORARYTOKEN](mc)},iapiEVENT_TIMER)}if(iapiLoginModeDownload){iapiDownloadHtcmd(1,1,0,mc.sessionToken.sessionToken)}}else{iapiTokenFailedActions(mc)}}else{if(iapiCalloutFunctions[lc]){setTimeout(function(){iapiCalloutFunctions[lc](mc)},iapiEVENT_TIMER)}}}}function iapiRequestFailed(d){var a=iapiGetRequest(d);if(!a){return}var b=a[1];if(iapiMakeRedirectRequest(a[4],a[5],b,a[3])){return}var c={errorCode:6,errorText:"Request timed out.",playerMessage:""};if(b==iapiCALLOUT_LOGIN){if(iapiCalloutFunctions[iapiCALLOUT_LOGIN]){iapiLoginFailedActions(c)}}else{if(b==iapiCALLOUT_TEMPORARYTOKEN){if(iapiCalloutFunctions[iapiCALLOUT_TEMPORARYTOKEN]){iapiTokenFailedActions(c)}}else{if(iapiCalloutFunctions[b]){setTimeout(function(){iapiCalloutFunctions[b](c)},iapiEVENT_TIMER)}}}}function iapiRegisterRequestId(b,d,f,a,c,e){iapiRequestIds.push([b,d,f,a,c,e])}function iapiGetRequest(a){var c;for(c in iapiRequestIds){arr=iapiRequestIds[c];if(arr[0]==a){iapiRequestIds.splice(c,1);if(arr[2]){clearTimeout(arr[2])}var b=document.getElementById(iapiIframename+"_"+a);if(b){document.getElementById(iapiDivname).removeChild(b)}return arr}}return null}function iapiClearRedirectRequests(b,c){var a=0;while(a<iapiRequestIds.length){arr=iapiRequestIds[a];if(arr[1]==b){var d=0;if(arr[4].indexOf("realMode=1")>0){d=1}if(d==c){iapiRequestIds.splice(a,1);if(arr[2]){clearTimeout(arr[2])}var e=document.getElementById(iapiIframename+"_"+arr[0]);if(e){document.getElementById(iapiDivname).removeChild(e)}continue}}a++}}function iapiHasRedirectRequest(a){var b=0;while(b<iapiRequestIds.length){arr=iapiRequestIds[b];if(arr[1]==a){return true}b++}return false}function iapiRedirectToWeblogin(){}function iapiGetCookie(b){for(var f=b+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var a=c[d];" "==a.charAt(0);){a=a.substring(1)}if(0==a.indexOf(f)){return a.substring(f.length,a.length)}}return""}function safariCookieSync(){var d=/Apple Computer/.test(navigator.vendor),e=navigator.cookieEnabled?!0:!1;if(1!=iapiConf.safariSyncDisabled&&d&&e){var c=iapiGetCookie("pasDomainSynced");if(!c){document.cookie="pasDomainSynced=1; max-age=31536000";var b="https://"+iapiConf.loginServer+"/DomainSync.php?origin="+encodeURIComponent(window.location.href);window.location.hash&&(b+="&hash="+encodeURIComponent(window.location.hash)),window.location.replace(b)}}};